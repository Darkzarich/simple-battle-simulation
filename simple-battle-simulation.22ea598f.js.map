{"version":3,"sources":["src/Score.js","src/constants.js","src/UI.js","src/AudioPlayer.js","src/Unit.js","src/Units.js","src/Game.js","index.js"],"names":["Score","sides","score","forEach","side","color","player","value","SCORE_WIDTH","SCORE_SEPARATOR_WIDTH","UNIT_SIZE","UNIT_BASE_SPEED","PLAYER1_COLOR","PLAYER2_COLOR","COLLISION_COLOR","COLLISION_WIDTH","UNIT_POWER_GROWTH","DIRECTION_RIGHT","DIRECTION_LEFT","UI","ctx","$ctx","fillStyle","fillRect","canvas","width","height","totalScore","Object","keys","reduce","prev","cur","scoreOffset","percentFromTotal","font","fillText","String","toFixed","Math","ceil","MAX_OVERLAY","sounds","background","require","bump","soundManager","Audio","Array","fill","map","audioElement","busy","AudioPlayer","play","audio","volume","loop","findFree","find","el","addEventListener","Unit","x","y","collided","direction","power","speed","renderUnit","handleOutOfBorder","max","floor","random","i","trace","length","offset","Units","unitsTotal","units","generateRandomUnits","generateRandomUnit","unit","move","collidedUnit","getCollidedUnit","setPower","killUnit","changeScore","filter","u","push","otherUnit","abs","Game","ui","init","playBackgroundMusic","clearFrame","moveUnits","drawInterface","window","requestAnimationFrame","startSimulation","bind","canv","document","getElementById","getContext","innerHeight","innerWidth","PLAYER1","PLAYER2","startButton","querySelector","remove"],"mappings":"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","file":"simple-battle-simulation.22ea598f.js","sourceRoot":"..","sourcesContent":["export default class Score {\r\n  constructor(sides) {\r\n    this.score = {};\r\n    this.sides = sides;\r\n\r\n    sides.forEach((side) => {\r\n      this.score[side.color] = 0;\r\n    });\r\n  }\r\n\r\n  getScore() {\r\n    return this.score;\r\n  }\r\n\r\n  changeScore(player, value) {\r\n    this.score[player] += value;\r\n  }\r\n}\r\n","export const SCORE_WIDTH = 70;\r\nexport const SCORE_SEPARATOR_WIDTH = 4;\r\nexport const UNIT_SIZE = 14;\r\nexport const UNIT_BASE_SPEED = 1;\r\nexport const PLAYER1_COLOR = 'green';\r\nexport const PLAYER2_COLOR = 'maroon';\r\nexport const COLLISION_COLOR = 'yellow';\r\nexport const COLLISION_WIDTH = 2;\r\nexport const UNIT_POWER_GROWTH = 1;\r\nexport const DIRECTION_RIGHT = 1;\r\nexport const DIRECTION_LEFT = -1;\r\n","import { SCORE_SEPARATOR_WIDTH, SCORE_WIDTH } from './constants';\r\n\r\nexport default class UI {\r\n  constructor(ctx, score) {\r\n    this.$ctx = ctx;\r\n    this.score = score;\r\n  }\r\n\r\n  clearFrame() {\r\n    this.$ctx.fillStyle = 'black';\r\n    this.$ctx.fillRect(0, 0, this.$ctx.canvas.width, this.$ctx.canvas.height);\r\n  }\r\n\r\n  drawInterface() {\r\n    // Draw separator\r\n    this.$ctx.fillStyle = 'white';\r\n    this.$ctx.fillRect(\r\n      this.$ctx.canvas.width - SCORE_WIDTH,\r\n      0,\r\n      SCORE_SEPARATOR_WIDTH,\r\n      this.$ctx.canvas.height\r\n    );\r\n\r\n    // Calc score appearance\r\n    const totalScore = Object.keys(this.score.score).reduce((prev, cur) => {\r\n      return prev + this.score.score[cur];\r\n    }, 0);\r\n\r\n    let scoreOffset = 0;\r\n\r\n    Object.keys(this.score.score).forEach((color) => {\r\n      const percentFromTotal = this.score.score[color] / totalScore;\r\n\r\n      this.$ctx.fillStyle = color;\r\n      this.$ctx.fillRect(\r\n        this.$ctx.canvas.width - SCORE_WIDTH + SCORE_SEPARATOR_WIDTH,\r\n        scoreOffset,\r\n        SCORE_WIDTH,\r\n        this.$ctx.canvas.height * percentFromTotal\r\n      );\r\n\r\n      this.$ctx.font = '20px arial';\r\n      this.$ctx.fillStyle = 'white';\r\n      this.$ctx.fillText(\r\n        String(`${(percentFromTotal * 100).toFixed(1)}%`),\r\n        this.$ctx.canvas.width -\r\n          SCORE_WIDTH -\r\n          SCORE_SEPARATOR_WIDTH +\r\n          SCORE_WIDTH / 5,\r\n        (this.$ctx.canvas.height * percentFromTotal) / 2 + scoreOffset\r\n      );\r\n\r\n      scoreOffset =\r\n        scoreOffset + Math.ceil(this.$ctx.canvas.height * percentFromTotal) + 2;\r\n    });\r\n  }\r\n}\r\n","const MAX_OVERLAY = 30;\r\n\r\n// sounds\r\nconst sounds = {\r\n  background: require('../assets/loop.mp3'),\r\n  bump: require('../assets/bump.mp3'),\r\n};\r\n\r\nconst soundManager = {\r\n  background: new Audio(sounds.background),\r\n  bump: Array(MAX_OVERLAY)\r\n    .fill()\r\n    .map(() => ({\r\n      audioElement: new Audio(sounds.bump),\r\n      busy: false,\r\n    })),\r\n};\r\n\r\nexport default class AudioPlayer {\r\n  static playBackgroundMusic() {\r\n    AudioPlayer.play(soundManager['background'], 0.7, true);\r\n  }\r\n\r\n  static bump() {\r\n    AudioPlayer.play(soundManager['bump'], 0.2, false);\r\n  }\r\n\r\n  static play(audio, volume, loop) {\r\n    if (audio instanceof Array) {\r\n      const findFree = audio.find((el) => !el.busy);\r\n\r\n      if (findFree) {\r\n        findFree.busy = true;\r\n        findFree.audioElement.loop = loop;\r\n        findFree.audioElement.volume = volume;\r\n        findFree.audioElement.play();\r\n        findFree.audioElement.addEventListener('ended', () => {\r\n          findFree.busy = false;\r\n        });\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    audio.loop = loop;\r\n    audio.volume = volume;\r\n    audio.play();\r\n  }\r\n}\r\n","import {\r\n  SCORE_WIDTH,\r\n  UNIT_SIZE,\r\n  COLLISION_COLOR,\r\n  COLLISION_WIDTH,\r\n  UNIT_BASE_SPEED,\r\n} from './constants';\r\n\r\nexport default class Unit {\r\n  constructor({ x, y, side }, ctx) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.side = side;\r\n    this.collided = false;\r\n    this.direction = side.direction;\r\n    this.$ctx = ctx;\r\n    this.power = 0;\r\n    this.speed = UNIT_BASE_SPEED;\r\n  }\r\n\r\n  move() {\r\n    this.renderUnit(this.x, this.y, this.side);\r\n\r\n    this.handleOutOfBorder();\r\n\r\n    this.speed = Math.max(1, Math.floor(this.power / 50) + 1); // every 50 power +1 speed\r\n\r\n    this.x = this.x + this.speed * this.direction;\r\n  }\r\n\r\n  handleOutOfBorder() {\r\n    if (this.x > this.$ctx.canvas.width - SCORE_WIDTH) {\r\n      this.y = this.y + (Math.floor(Math.random() * 100) % UNIT_SIZE) * 2; // random drop down\r\n      this.x = 0;\r\n    }\r\n\r\n    if (this.x < 0) {\r\n      this.y = this.y + (Math.floor(Math.random() * 100) % UNIT_SIZE) * 2; // random drop down\r\n      this.x = this.$ctx.canvas.width - SCORE_WIDTH;\r\n    }\r\n\r\n    if (this.y > this.$ctx.canvas.height) {\r\n      this.y = 0;\r\n    }\r\n  }\r\n\r\n  setPower(power) {\r\n    this.power = power;\r\n  }\r\n\r\n  renderUnit() {\r\n    // draw trace\r\n\r\n    for (let i = 1; i < this.side.trace.length + 1; i++) {\r\n      this.$ctx.fillStyle = this.side.trace[i - 1];\r\n      this.$ctx.fillRect(\r\n        this.x - 3 * i * this.direction,\r\n        this.y + 1 * i,\r\n        UNIT_SIZE,\r\n        UNIT_SIZE - 2 * i\r\n      );\r\n    }\r\n\r\n    // draw unit\r\n    this.$ctx.fillStyle = this.side.color;\r\n    this.$ctx.fillRect(this.x, this.y, UNIT_SIZE, UNIT_SIZE);\r\n\r\n    // collision border\r\n    if (this.collided) {\r\n      const offset = this.direction === 1 ? UNIT_SIZE - COLLISION_WIDTH : 0;\r\n\r\n      this.$ctx.fillStyle = COLLISION_COLOR;\r\n      this.$ctx.fillRect(\r\n        this.x + offset,\r\n        this.y,\r\n        COLLISION_WIDTH + 10,\r\n        UNIT_SIZE\r\n      );\r\n    }\r\n  }\r\n}\r\n","import { UNIT_SIZE, COLLISION_WIDTH, UNIT_POWER_GROWTH } from './constants';\r\nimport AudioPlayer from './AudioPlayer';\r\nimport Unit from './Unit';\r\n\r\nexport default class Units {\r\n  constructor(ctx, unitsTotal, sides, score) {\r\n    this.$ctx = ctx;\r\n    this.units = this.generateRandomUnits(unitsTotal, sides);\r\n    this.score = score;\r\n  }\r\n\r\n  generateRandomUnits(unitsTotal, sides) {\r\n    let i = 0;\r\n\r\n    return new Array(unitsTotal).fill().map(() => {\r\n      if (i < sides.length - 1) i = i + 1;\r\n      else i = 0;\r\n\r\n      return this.generateRandomUnit(sides[i]);\r\n    });\r\n  }\r\n\r\n  generateRandomUnit(side) {\r\n    return new Unit(\r\n      {\r\n        x: Math.floor(Math.random() * 10000) % this.$ctx.canvas.width,\r\n        y: Math.floor(Math.random() * 10000) % this.$ctx.canvas.height,\r\n        side,\r\n      },\r\n      this.$ctx\r\n    );\r\n  }\r\n\r\n  moveUnits() {\r\n    this.units.forEach((unit) => {\r\n      unit.move();\r\n      const collidedUnit = this.getCollidedUnit(unit);\r\n\r\n      if (collidedUnit) {\r\n        // draw collision border\r\n        collidedUnit.collided = true;\r\n        unit.collided = true;\r\n\r\n        AudioPlayer.bump();\r\n\r\n        if (unit.power >= collidedUnit.power) {\r\n          unit.setPower(0);\r\n          this.killUnit(collidedUnit);\r\n          this.score.changeScore(unit.side.color, 1);\r\n        } else {\r\n          collidedUnit.setPower(0);\r\n          this.killUnit(unit);\r\n          this.score.changeScore(collidedUnit.side.color, 1);\r\n        }\r\n\r\n        return;\r\n      }\r\n\r\n      unit.collided = false;\r\n      unit.setPower(unit.power + UNIT_POWER_GROWTH);\r\n    });\r\n  }\r\n\r\n  killUnit(unit) {\r\n    this.units = this.units.filter((u) => u !== unit);\r\n    this.units.push(this.generateRandomUnit(unit.side));\r\n  }\r\n\r\n  getCollidedUnit(unit) {\r\n    for (const otherUnit of this.units) {\r\n      if (\r\n        Math.abs(otherUnit.x - unit.x) <= UNIT_SIZE - COLLISION_WIDTH &&\r\n        Math.abs(otherUnit.y - unit.y) <= UNIT_SIZE - COLLISION_WIDTH &&\r\n        otherUnit.side.color !== unit.side.color\r\n      ) {\r\n        return otherUnit;\r\n      }\r\n    }\r\n  }\r\n}\r\n","import Score from './Score';\r\nimport UI from './UI';\r\nimport Units from './Units';\r\nimport AudioPlayer from './AudioPlayer';\r\n\r\nexport default class Game {\r\n  constructor(ctx, unitsTotal, sides) {\r\n    this.$ctx = ctx;\r\n    this.score = new Score(sides);\r\n    this.ui = new UI(ctx, this.score);\r\n    this.units = new Units(ctx, unitsTotal, sides, this.score);\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    AudioPlayer.playBackgroundMusic();\r\n  }\r\n\r\n  startSimulation() {\r\n    this.ui.clearFrame();\r\n\r\n    this.units.moveUnits();\r\n\r\n    this.ui.drawInterface();\r\n\r\n    window.requestAnimationFrame(this.startSimulation.bind(this));\r\n  }\r\n}\r\n","import Game from './src/Game';\r\nimport {\r\n  PLAYER1_COLOR,\r\n  PLAYER2_COLOR,\r\n  DIRECTION_LEFT,\r\n  DIRECTION_RIGHT,\r\n} from './src/constants';\r\n\r\nconst canv = document.getElementById('canv');\r\nconst $ctx = canv.getContext('2d');\r\n\r\ncanv.height = window.innerHeight;\r\ncanv.width = window.innerWidth;\r\n\r\nconst PLAYER1 = {\r\n  color: PLAYER1_COLOR,\r\n  trace: ['#008000a8', '#00800054'],\r\n  direction: DIRECTION_RIGHT,\r\n};\r\n\r\nconst PLAYER2 = {\r\n  color: PLAYER2_COLOR,\r\n  trace: ['#800000a8', '#80000054'],\r\n  direction: DIRECTION_LEFT,\r\n};\r\n\r\nconst startButton = document.querySelector('#start');\r\n\r\nstartButton.addEventListener('click', () => {\r\n  new Game($ctx, Math.ceil(Math.max(25, (canv.height * canv.width) / 12000)), [\r\n    PLAYER1,\r\n    PLAYER2,\r\n  ]).startSimulation();\r\n  startButton.remove();\r\n});\r\n"]}