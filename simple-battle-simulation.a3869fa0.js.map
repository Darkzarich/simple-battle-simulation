{"version":3,"sources":["src/Score.js","src/constants.js","src/UI.js","src/AudioPlayer.js","src/Unit.js","src/Units.js","src/Game.js","index.js"],"names":["Score","sides","score","forEach","side","color","player","value","BORDER","SCORE_WIDTH","SCORE_SEPARATOR_WIDTH","UNIT_SIZE","UNIT_BASE_SPEED","PLAYER1_COLOR","PLAYER2_COLOR","COLLISION_COLOR","COLLISION_WIDTH","UNIT_POWER_GROWTH","DIRECTION_RIGHT","DIRECTION_LEFT","UI","ctx","$ctx","fillStyle","fillRect","canv","width","height","totalScore","Object","keys","reduce","prev","cur","scoreOffset","percentFromTotal","font","fillText","String","Math","ceil","sounds","background","Audio","require","bump","AudioPlayer","play","audio","volume","loop","newAudio","cloneNode","Unit","x","y","collided","direction","power","speed","renderUnit","handleOutOfBorder","max","floor","random","i","trace","length","offset","Units","unitsTotal","units","generateRandomUnits","Array","fill","map","generateRandomUnit","unit","move","collidedUnit","getCollidedUnit","setPower","killUnit","changeScore","filter","u","push","otherUnit","abs","Game","ui","init","playBackgroundMusic","clearFrame","moveUnits","drawInterface","window","requestAnimationFrame","startSimulation","bind","document","getElementById","getContext","PLAYER1","PLAYER2","startButton","querySelector","addEventListener","remove"],"mappings":"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","file":"simple-battle-simulation.a3869fa0.js","sourceRoot":"..","sourcesContent":["export default class Score {\r\n  constructor(sides) {\r\n    this.score = {};\r\n    this.sides = sides;\r\n\r\n    sides.forEach((side) => {\r\n      this.score[side.color] = 0;\r\n    });\r\n  }\r\n\r\n  getScore() {\r\n    return this.score;\r\n  }\r\n\r\n  changeScore(player, value) {\r\n    this.score[player] += value;\r\n  }\r\n}\r\n","export const BORDER = 400;\r\nexport const SCORE_WIDTH = 100;\r\nexport const SCORE_SEPARATOR_WIDTH = 4;\r\nexport const UNIT_SIZE = 14;\r\nexport const UNIT_BASE_SPEED = 1;\r\nexport const PLAYER1_COLOR = 'green';\r\nexport const PLAYER2_COLOR = 'maroon';\r\nexport const COLLISION_COLOR = 'yellow';\r\nexport const COLLISION_WIDTH = 2;\r\nexport const UNIT_POWER_GROWTH = 1;\r\nexport const DIRECTION_RIGHT = 1;\r\nexport const DIRECTION_LEFT = -1;\r\n","import {\r\n    BORDER,\r\n    SCORE_SEPARATOR_WIDTH,\r\n    SCORE_WIDTH\r\n  } from './constants';\r\n\r\nexport default class UI {\r\n  constructor(ctx, score) {\r\n    this.$ctx = ctx;\r\n    this.score = score;\r\n  }\r\n\r\n  clearFrame() {\r\n    this.$ctx.fillStyle = 'black';\r\n    this.$ctx.fillRect(0, 0, canv.width, canv.height);\r\n  }\r\n\r\n  drawInterface() {\r\n    // Draw separator\r\n    this.$ctx.fillStyle = 'white';\r\n    this.$ctx.fillRect(BORDER, 0, SCORE_SEPARATOR_WIDTH, BORDER);\r\n\r\n    // Calc score appearance\r\n    const totalScore = Object.keys(this.score.score).reduce((prev, cur) => {\r\n      return prev + this.score.score[cur];\r\n    }, 0);\r\n\r\n    let scoreOffset = 0;\r\n\r\n    Object.keys(this.score.score).forEach((color) => {\r\n      const percentFromTotal = this.score.score[color] / totalScore;\r\n\r\n      this.$ctx.fillStyle = color;\r\n      this.$ctx.fillRect(\r\n        BORDER + SCORE_SEPARATOR_WIDTH,\r\n        scoreOffset,\r\n        SCORE_WIDTH,\r\n        BORDER * percentFromTotal\r\n      );\r\n\r\n      this.$ctx.font = '25px arial';\r\n      this.$ctx.fillStyle = 'white';\r\n      this.$ctx.fillText(\r\n        String(`${Math.ceil(percentFromTotal * 100)}%`),\r\n        BORDER + SCORE_SEPARATOR_WIDTH + SCORE_WIDTH / 4,\r\n        (BORDER * percentFromTotal) / 2 + scoreOffset\r\n      );\r\n\r\n      scoreOffset = scoreOffset + Math.ceil(BORDER * percentFromTotal) + 2;\r\n    });\r\n  }\r\n}\r\n","const sounds = {\r\n    background: new Audio(require('../assets/loop.mp3')),\r\n    bump: new Audio(require('../assets/bump.mp3'))\r\n}\r\nexport default class AudioPlayer {\r\n  static playBackgroundMusic() {\r\n    AudioPlayer.play(sounds['background'], 0.7, true)\r\n  }\r\n\r\n  static bump() {\r\n    AudioPlayer.play(sounds['bump'], 0.3, false)\r\n  }\r\n\r\n  static play(audio, volume, loop) {\r\n    const newAudio = audio.cloneNode(true)\r\n    newAudio.loop = loop;\r\n    newAudio.volume = volume;\r\n    newAudio.play();\r\n  }\r\n}\r\n","import {\r\n  BORDER,\r\n  UNIT_SIZE,\r\n  COLLISION_COLOR,\r\n  COLLISION_WIDTH,\r\n  UNIT_BASE_SPEED,\r\n} from './constants';\r\n\r\nexport default class Unit {\r\n  constructor({ x, y, side }, ctx) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.side = side;\r\n    this.collided = false;\r\n    this.direction = side.direction;\r\n    this.$ctx = ctx;\r\n    this.power = 0;\r\n    this.speed = UNIT_BASE_SPEED;\r\n  }\r\n\r\n  move() {\r\n    this.renderUnit(this.x, this.y, this.side);\r\n\r\n    this.handleOutOfBorder();\r\n\r\n    this.speed = Math.max(1, Math.floor(this.power / 50) + 1); // every 50 power +1 speed\r\n\r\n    this.x = this.x + this.speed * this.direction;\r\n  }\r\n\r\n  handleOutOfBorder() {\r\n    if (this.x > BORDER) {\r\n      this.y = this.y + (Math.floor(Math.random() * 100) % UNIT_SIZE) * 2; // random drop down\r\n      this.x = 0;\r\n    }\r\n\r\n    if (this.x < 0) {\r\n      this.y = this.y + (Math.floor(Math.random() * 100) % UNIT_SIZE) * 2; // random drop down\r\n      this.x = BORDER;\r\n    }\r\n\r\n    if (this.y > BORDER) {\r\n      this.y = 0;\r\n    }\r\n  }\r\n\r\n  setPower(power) {\r\n    this.power = power;\r\n  }\r\n\r\n  renderUnit() {\r\n    // draw trace\r\n\r\n    for (let i = 1; i < this.side.trace.length + 1; i++) {\r\n      this.$ctx.fillStyle = this.side.trace[i - 1];\r\n      this.$ctx.fillRect(\r\n        this.x - 3 * i * this.direction,\r\n        this.y + 1 * i,\r\n        UNIT_SIZE,\r\n        UNIT_SIZE - 2 * i\r\n      );\r\n    }\r\n\r\n    // draw unit\r\n    this.$ctx.fillStyle = this.side.color;\r\n    this.$ctx.fillRect(this.x, this.y, UNIT_SIZE, UNIT_SIZE);\r\n\r\n    // collision border\r\n    if (this.collided) {\r\n      const offset = this.direction === 1 ? UNIT_SIZE - COLLISION_WIDTH : 0;\r\n\r\n      this.$ctx.fillStyle = COLLISION_COLOR;\r\n      this.$ctx.fillRect(\r\n        this.x + offset,\r\n        this.y,\r\n        COLLISION_WIDTH + 10,\r\n        UNIT_SIZE\r\n      );\r\n    }\r\n  }\r\n}\r\n","import { UNIT_SIZE, COLLISION_WIDTH, UNIT_POWER_GROWTH } from './constants';\r\nimport AudioPlayer from './AudioPlayer';\r\nimport Unit from './Unit';\r\n\r\nexport default class Units {\r\n  constructor(ctx, unitsTotal, sides, score) {\r\n    this.$ctx = ctx;\r\n    this.units = this.generateRandomUnits(unitsTotal, sides);\r\n    this.score = score;\r\n  }\r\n\r\n  generateRandomUnits(unitsTotal, sides) {\r\n    let i = 0;\r\n\r\n    return new Array(unitsTotal).fill().map(() => {\r\n      if (i < sides.length - 1) i = i + 1;\r\n      else i = 0;\r\n\r\n      return this.generateRandomUnit(sides[i]);\r\n    });\r\n  }\r\n\r\n  generateRandomUnit(side) {\r\n    return new Unit(\r\n      {\r\n        x: Math.floor(Math.random() * 1000) % 400,\r\n        y: Math.floor(Math.random() * 1000) % 400,\r\n        side,\r\n      },\r\n      this.$ctx\r\n    );\r\n  }\r\n\r\n  moveUnits() {\r\n    this.units.forEach((unit) => {\r\n      unit.move();\r\n      const collidedUnit = this.getCollidedUnit(unit);\r\n\r\n      if (collidedUnit) {\r\n        // draw collision border\r\n        collidedUnit.collided = true;\r\n        unit.collided = true;\r\n\r\n        AudioPlayer.bump();\r\n\r\n        if (unit.power >= collidedUnit.power) {\r\n          unit.setPower(0);\r\n          this.killUnit(collidedUnit);\r\n          this.score.changeScore(unit.side.color, 1);\r\n        } else {\r\n          collidedUnit.setPower(0);\r\n          this.killUnit(unit);\r\n          this.score.changeScore(collidedUnit.side.color, 1);\r\n        }\r\n\r\n        return;\r\n      }\r\n\r\n      unit.collided = false;\r\n      unit.setPower(unit.power + UNIT_POWER_GROWTH);\r\n    });\r\n  }\r\n\r\n  killUnit(unit) {\r\n    this.units = this.units.filter((u) => u !== unit);\r\n    this.units.push(this.generateRandomUnit(unit.side));\r\n  }\r\n\r\n  getCollidedUnit(unit) {\r\n    for (const otherUnit of this.units) {\r\n      if (\r\n        Math.abs(otherUnit.x - unit.x) <= UNIT_SIZE - COLLISION_WIDTH &&\r\n        Math.abs(otherUnit.y - unit.y) <= UNIT_SIZE - COLLISION_WIDTH &&\r\n        otherUnit.side.color !== unit.side.color\r\n      ) {\r\n        return otherUnit;\r\n      }\r\n    }\r\n  }\r\n}\r\n","import Score from './Score';\r\nimport UI from './UI';\r\nimport Units from './Units';\r\nimport AudioPlayer from './AudioPlayer';\r\n\r\nexport default class Game {\r\n  constructor(ctx, unitsTotal, sides) {\r\n    this.$ctx = ctx;\r\n    this.score = new Score(sides);\r\n    this.ui = new UI(ctx, this.score);\r\n    this.units = new Units(ctx, unitsTotal, sides, this.score);\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    AudioPlayer.playBackgroundMusic();\r\n  }\r\n\r\n  startSimulation() {\r\n    this.ui.clearFrame();\r\n\r\n    this.units.moveUnits();\r\n\r\n    this.ui.drawInterface();\r\n\r\n    window.requestAnimationFrame(this.startSimulation.bind(this));\r\n  }\r\n}\r\n","import Game from './src/Game';\r\nimport {\r\n  PLAYER1_COLOR,\r\n  PLAYER2_COLOR,\r\n  DIRECTION_LEFT,\r\n  DIRECTION_RIGHT,\r\n} from './src/constants';\r\n\r\nconst canv = document.getElementById('canv');\r\nconst $ctx = canv.getContext('2d');\r\n\r\nconst PLAYER1 = {\r\n  color: PLAYER1_COLOR,\r\n  trace: ['#008000a8', '#00800054'],\r\n  direction: DIRECTION_RIGHT,\r\n};\r\n\r\nconst PLAYER2 = {\r\n  color: PLAYER2_COLOR,\r\n  trace: ['#800000a8', '#80000054'],\r\n  direction: DIRECTION_LEFT,\r\n};\r\n\r\nconst startButton = document.querySelector('#start');\r\n\r\nstartButton.addEventListener('click', () => {\r\n  new Game($ctx, 50, [PLAYER1, PLAYER2]).startSimulation();\r\n  startButton.remove();\r\n});\r\n"]}